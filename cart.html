<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>

<div class="container">
<h2>Customize & Order</h2>

<input id="qty" type="number" placeholder="Quantity">
<input id="text" placeholder="Custom Text">
<input type="file" id="logo">

<button onclick="placeOrder()">Place Order</button>
</div>

<script type="module">
import { supabase } from "../supabase/config.js";

async function placeOrder(){
  const { data: user } = await supabase.auth.getUser();

  const { data: order } = await supabase.from("orders").insert({
    user_id: user.user.id,
    total: 0
  }).select().single();

  await supabase.from("order_items").insert({
    order_id: order.id,
    product_id: localStorage.getItem("product"),
    quantity: qty.value,
    custom_text: text.value
  });

  location.href = "order-success.html";
}
</script>
</body>
</html>
