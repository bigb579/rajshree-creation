<!DOCTYPE html>
<html>
<head><link rel="stylesheet" href="assets/css/style.css"></head>
<body>
<h2 style="text-align:center">Admin Dashboard</h2>
<div id="orders" style="max-width:1000px;margin:auto;padding:30px"></div>

<script type="module">
import { supabase } from "./supabase/config.js";

const { data:user } = await supabase.auth.getUser()
const { data:profile } = await supabase.from("profiles").select("role").eq("id",user.user.id).single()
if(profile.role!=="admin") location.href="products.html"

const { data:orders } = await supabase.from("orders").select(`id,status,created_at,order_items(quantity,custom_text,products(name))`)

const box=document.getElementById("orders")
orders.forEach(o=>{
box.innerHTML+=`
<div style="background:white;margin-bottom:20px;padding:20px;border-radius:10px">
<b>Order:</b> ${o.id}<br>
<b>Status:</b> ${o.status}<br>
${o.order_items.map(i=>`${i.products.name} — Qty:${i.quantity} — ${i.custom_text}`).join("<br>")}
</div>`
})
</script>
</body>

